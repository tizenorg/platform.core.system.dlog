diff a/src/shared/logcommon.c b/src/shared/logcommon.c	(rejected hunks)
@@ -64,3 +68,36 @@ void syslog_critical_failure (const char * message)
 	closelog ();
 }
 
+int recv_file_descriptor(int socket)
+{
+	struct msghdr message;
+	struct iovec iov[1];
+	struct cmsghdr *control_message = NULL;
+	char ctrl_buf[CMSG_SPACE(sizeof(int))];
+	char data[1];
+	int res;
+
+	memset(&message, 0, sizeof(struct msghdr));
+	memset(ctrl_buf, 0, CMSG_SPACE(sizeof(int)));
+
+	/* For the dummy data */
+	iov[0].iov_base = data;
+	iov[0].iov_len = sizeof(data);
+
+	message.msg_name = NULL;
+	message.msg_namelen = 0;
+	message.msg_control = ctrl_buf;
+	message.msg_controllen = CMSG_SPACE(sizeof(int));
+	message.msg_iov = iov;
+	message.msg_iovlen = 1;
+
+	if((res = recvmsg(socket, &message, 0)) <= 0)
+		return res;
+
+	/* Iterate through header to find if there is a file descriptor */
+	for(control_message = CMSG_FIRSTHDR(&message); control_message != NULL; control_message = CMSG_NXTHDR(&message, control_message)) {
+		if( (control_message->cmsg_level == SOL_SOCKET) && (control_message->cmsg_type == SCM_RIGHTS) )
+			return *(CMSG_DATA(control_message));
+	}
+	return -1;
+}
